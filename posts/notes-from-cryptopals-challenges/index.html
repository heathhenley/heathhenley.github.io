<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>The Cryptopals Challenges</title><meta property="og:title" content="The Cryptopals Challenges"><meta name=twitter:title content="The Cryptopals Challenges"><meta name=description content="Summary and notes about my learnings from the Cryptopals Crypto Challenges. I started knowing nothing about cryptography, except that you can see Tux the penguin if you encrypt him with ECB mode. I am pushing updates as I have time to work through the challenges. Picking them off one at a time, so this page will be a constant work in progress."><meta property="og:description" content="Summary and notes about my learnings from the Cryptopals Crypto Challenges. I started knowing nothing about cryptography, except that you can see Tux the penguin if you encrypt him with ECB mode. I am pushing updates as I have time to work through the challenges. Picking them off one at a time, so this page will be a constant work in progress."><meta name=twitter:description content="Summary and notes about my learnings from the Cryptopals Crypto Challenges. I started knowing nothing about cryptography, except that you can see Tux the penguin if you encrypt him with ECB mode. I am …"><meta name=author content="Heath Henley"><meta property="og:site_name" content="Blogging by Heath™"><meta property="og:url" content="https://heathhenley.dev/posts/notes-from-cryptopals-challenges/"><meta property="og:image" content="https://heathhenley.dev/og_image_main.png"><meta name=twitter:image content="https://heathhenley.dev/og_image_main.png"><meta name=twitter:card content="summary"><meta name=twitter:site content="@Heath_Henley"><meta name=twitter:creator content="@Heath_Henley"><meta property="og:type" content="article"><meta name=generator content="Hugo 0.118.2"><script async src="https://www.googletagmanager.com/gtag/js?id=G-LHHPTPJRGL"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LHHPTPJRGL")</script><link rel=stylesheet href=https://heathhenley.dev/css/style.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/sakura.css/css/sakura.css type=text/css><link rel=stylesheet href=https://heathhenley.dev/css/custom.css><link rel=icon type=image/x-icon href=https://heathhenley.dev/favicon.png><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async>MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"}),MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}})</script><script type=text/javascript src=https://heathhenley.dev/js/bundle.js></script></head><body><a href=#main class="skip-link p-screen-reader-text">Skip to content</a><svg xmlns="http://www.w3.org/2000/svg" style="display:none" aria-hidden="true"><symbol id="icon-500px" viewBox="0 0 16 16"><g><path d="M3.953 10.512a5.24 5.24.0 006.996 3.141c.625-.262 1.184-.641 1.666-1.122s.859-1.041 1.122-1.666c.272-.647.412-1.331.412-2.037s-.137-1.394-.412-2.037c-.262-.625-.641-1.184-1.122-1.666s-1.041-.859-1.666-1.122A5.226 5.226.0 008.912 3.59c-.716.0-1.431.144-2.066.413-.509.216-1.372.769-1.875 1.291l-.003.003V.984h7.241c.262-.003.262-.372.262-.491.0-.122.0-.487-.266-.491H4.377a.343.343.0 00-.344.341v6.066c0 .197.244.338.472.384.444.094.544-.047.653-.197l.016-.019c.166-.247.681-.766.688-.772a4.262 4.262.0 013.037-1.25c1.147.0 2.222.444 3.028 1.25a4.245 4.245.0 011.256 3.019 4.236 4.236.0 01-1.25 3.019 4.336 4.336.0 01-3.047 1.25 4.136 4.136.0 01-2.159-.597l.003-3.688c0-.491.213-1.028.572-1.431a2.09 2.09.0 011.588-.716c.594.0 1.15.225 1.566.634.409.406.637.95.637 1.528A2.179 2.179.0 018.887 11.02c-.238.0-.672-.106-.691-.109-.25-.075-.356.272-.391.387-.134.441.069.528.109.541.397.125.659.147 1.003.147a3.173 3.173.0 003.169-3.169c0-1.734-1.422-3.144-3.166-3.144-.856.0-1.659.328-2.263.919-.575.566-.903 1.319-.903 2.069v.019c-.003.094-.003 2.306-.006 3.031l-.003-.003c-.328-.363-.653-.919-.869-1.488-.084-.222-.275-.184-.534-.103-.125.034-.469.141-.391.394zm3.722-.865c0 .106.097.2.156.253l.019.019c.1.097.194.147.281.147a.181.181.0 00.131-.05c.044-.041.537-.544.588-.591l.553.55c.05.056.106.088.172.088.088.0.184-.053.284-.156.238-.244.119-.375.063-.438l-.559-.559.584-.588c.128-.137.016-.284-.097-.397-.162-.162-.322-.206-.422-.112l-.581.581-.588-.588a.16.16.0 00-.113-.047c-.078.0-.172.053-.275.156-.181.181-.219.306-.125.406l.588.584-.584.584c-.053.05-.078.103-.075.156zm1.278-7.931c-.938.0-1.938.191-2.669.506a.207.207.0 00-.134.181.753.753.0 00.069.337c.047.116.166.425.4.334a6.689 6.689.0 012.334-.444 6.35 6.35.0 012.469.497c.622.263 1.206.644 1.844 1.194a.22.22.0 00.147.059c.125.0.244-.122.347-.237.169-.191.287-.35.119-.509a6.858 6.858.0 00-2.1-1.356 7.326 7.326.0 00-2.825-.563zM14.006 13.3c-.113-.113-.209-.178-.294-.203s-.162-.006-.222.053l-.056.056a6.32 6.32.0 01-6.938 1.356 6.336 6.336.0 01-2.013-1.356 6.046 6.046.0 01-1.356-2.012c-.288-.713-.381-1.247-.413-1.422-.003-.016-.006-.028-.006-.037-.041-.206-.231-.222-.503-.178-.112.019-.459.072-.428.319v.006a7.261 7.261.0 002.04 3.994 7.266 7.266.0 0010.288.0l.059-.059c.069-.084.134-.225-.159-.516z"/></g></symbol><symbol id="icon-codepen" viewBox="0 0 16 16"><g><path d="M14.777 5.751l-7-4.667a.5.5.0 00-.555.0l-7 4.667a.501.501.0 00-.223.416v4.667c0 .167.084.323.223.416l7 4.667a.5.5.0 00.554.0l7-4.667a.501.501.0 00.223-.416V6.167a.501.501.0 00-.223-.416zM7.5 10.232 4.901 8.5 7.5 6.768 10.099 8.5 7.5 10.232zM8 5.899V2.434l5.599 3.732L11 7.898l-3-2zm-1 0-3 2-2.599-1.732L7 2.435V5.9zM3.099 8.5 1 9.899V7.101L3.099 8.5zM4 9.101l3 2v3.465l-5.599-3.732L4 9.102zm4 2 3-2 2.599 1.732L8 14.565V11.1zM11.901 8.5 14 7.101v2.798L11.901 8.5z"/></g></symbol><symbol id="icon-dribbble" viewBox="0 0 16 16"><g><path d="M8 16c-4.412.0-8-3.588-8-8s3.587-8 8-8c4.412.0 8 3.587 8 8s-3.588 8-8 8zm6.747-6.906c-.234-.075-2.116-.634-4.256-.291a29.7 29.7.0 011.328 4.872 6.845 6.845.0 002.928-4.581zM10.669 14.3c-.103-.6-.497-2.688-1.456-5.181-.016.006-.031.009-.044.016-3.856 1.344-5.241 4.016-5.362 4.266a6.807 6.807.0 006.863.9zm-7.747-1.722c.156-.266 2.031-3.369 5.553-4.509a7.04 7.04.0 01.269-.081 24.04 24.04.0 00-.553-1.159c-3.409 1.022-6.722.978-7.022.975-.003.069-.003.138-.003.209.0 1.753.666 3.356 1.756 4.566zM1.313 6.609c.306.003 3.122.016 6.319-.831A43.092 43.092.0 005.098 1.825 6.854 6.854.0 001.314 6.609zM6.4 1.366a36.612 36.612.0 012.55 4c2.431-.909 3.459-2.294 3.581-2.469A6.799 6.799.0 006.4 1.366zm6.891 2.325c-.144.194-1.291 1.663-3.816 2.694.159.325.313.656.453.991.05.119.1.234.147.353 2.275-.284 4.534.172 4.759.219A6.816 6.816.0 0013.29 3.692z"/></g></symbol><symbol id="icon-facebook" viewBox="0 0 16 16"><g><path d="M9.5 3H12V0H9.5C7.57.0 6 1.57 6 3.5V5H4v3h2v8h3V8h2.5l.5-3H9V3.5c0-.271.229-.5.5-.5z"/></g></symbol><symbol id="icon-feed" viewBox="0 0 16 16"><g><path d="M2.13 11.733c-1.175.0-2.13.958-2.13 2.126.0 1.174.955 2.122 2.13 2.122a2.126 2.126.0 002.133-2.122A2.133 2.133.0 002.13 11.733zM.002 5.436v3.067c1.997.0 3.874.781 5.288 2.196a7.45 7.45.0 012.192 5.302h3.08c0-5.825-4.739-10.564-10.56-10.564zM.006.0v3.068C7.128 3.068 12.924 8.87 12.924 16H16C16 7.18 8.824.0.006.0z"/></g></symbol><symbol id="icon-flickr" viewBox="0 0 16 16"><g><path d="M0 8.5a3.5 3.5.0 117 0 3.5 3.5.0 01-7 0zm9 0a3.5 3.5.0 117 0 3.5 3.5.0 01-7 0z"/></g></symbol><symbol id="icon-github" viewBox="0 0 16 16"><g><path d="M8 .198A8 8 0 005.471 15.789c.4.074.547-.174.547-.385.0-.191-.008-.821-.011-1.489-2.226.484-2.695-.944-2.695-.944-.364-.925-.888-1.171-.888-1.171-.726-.497.055-.486.055-.486.803.056 1.226.824 1.226.824.714 1.223 1.872.869 2.328.665.072-.517.279-.87.508-1.07-1.777-.202-3.645-.888-3.645-3.954.0-.873.313-1.587.824-2.147-.083-.202-.357-1.015.077-2.117.0.0.672-.215 2.201.82A7.672 7.672.0 018 4.066c.68.003 1.365.092 2.004.269 1.527-1.035 2.198-.82 2.198-.82.435 1.102.162 1.916.079 2.117.513.56.823 1.274.823 2.147.0 3.073-1.872 3.749-3.653 3.947.287.248.543.735.543 1.481.0 1.07-.009 1.932-.009 2.195.0.213.144.462.55.384A8 8 0 008.001.196z"/></g></symbol><symbol id="icon-gitlab" viewBox="0 0 28 28"><g><path d="M1.625 11.031 14 26.89.437 17.046a1.092 1.092.0 01-.391-1.203l1.578-4.813zm7.219.0h10.313L14.001 26.89zM5.75 1.469l3.094 9.562H1.625l3.094-9.562a.548.548.0 011.031.0zm20.625 9.562 1.578 4.813a1.09 1.09.0 01-.391 1.203l-13.563 9.844 12.375-15.859zm0 0h-7.219l3.094-9.562a.548.548.0 011.031.0z"/></g></symbol><symbol id="icon-google-plus" viewBox="0 0 16 16"><g><path d="M5.091 7.147v1.747h2.888c-.116.75-.872 2.197-2.888 2.197-1.737.0-3.156-1.441-3.156-3.216s1.419-3.216 3.156-3.216c.991.0 1.65.422 2.028.784L8.5 4.112c-.888-.828-2.037-1.331-3.409-1.331C2.275 2.784.0 5.059.0 7.875s2.275 5.091 5.091 5.091c2.937.0 4.888-2.066 4.888-4.975.0-.334-.037-.591-.081-.844H5.092zM16 7h-1.5V5.5H13V7h-1.5v1.5H13V10h1.5V8.5H16z"/></g></symbol><symbol id="icon-instagram" viewBox="0 0 22 22"><g><path d="M15.445.0H6.554A6.559 6.559.0 000 6.554v8.891A6.559 6.559.0 006.554 22h8.891a6.56 6.56.0 006.554-6.555V6.554A6.557 6.557.0 0015.445.0zm4.342 15.445a4.343 4.343.0 01-4.342 4.342H6.554a4.341 4.341.0 01-4.341-4.342V6.554a4.34 4.34.0 014.341-4.341h8.891a4.342 4.342.0 014.341 4.341l.001 8.891z"/><path d="M11 5.312A5.693 5.693.0 005.312 11 5.694 5.694.0 0011 16.688 5.694 5.694.0 0016.688 11 5.693 5.693.0 0011 5.312zm0 9.163a3.475 3.475.0 11-.001-6.95 3.475 3.475.0 01.001 6.95zm5.7-10.484a1.363 1.363.0 11-1.364 1.364c0-.752.51-1.364 1.364-1.364z"/></g></symbol><symbol id="icon-linkedin" viewBox="0 0 16 16"><g><path d="M6 6h2.767v1.418h.04C9.192 6.727 10.134 6 11.539 6 14.46 6 15 7.818 15 10.183V15h-2.885v-4.27c0-1.018-.021-2.329-1.5-2.329-1.502.0-1.732 1.109-1.732 2.255V15H6V6zM1 6h3v9H1V6zM4 3.5A1.5 1.5.0 11.999 3.499 1.5 1.5.0 014 3.5z"/></g></symbol><symbol id="icon-mail" viewBox="0 0 22 18"><g><path fill="#000" d="M0 17.225V.776h22v16.447H0v.002zm3.011-1.815h15.978l-5.111-5.115L11 13.179l-2.877-2.883-5.112 5.114zm-1.216-1.275 5.077-5.09L1.795 3.98v10.155zm13.332-5.09 5.079 5.09V3.979l-5.079 5.066zm-4.126 1.588 8.022-8.027-16.045-.001 8.023 8.028z"/></g></symbol><symbol id="icon-medium" viewBox="0 0 24 24"><g><path d="M22.085 4.733 24 2.901V2.5h-6.634l-4.728 11.768L7.259 2.5H.303v.401L2.54 5.594c.218.199.332.49.303.783V16.96c.069.381-.055.773-.323 1.05L0 21.064v.396h7.145v-.401l-2.52-3.049a1.244 1.244.0 01-.347-1.05V7.806l6.272 13.659h.729l5.393-13.659v10.881c0 .287.0.346-.188.534l-1.94 1.877v.402h9.412v-.401l-1.87-1.831a.556.556.0 01-.214-.534V5.267a.554.554.0 01.213-.534z"/></g></symbol><symbol id="icon-npm" viewBox="0 0 16 16"><g><path d="M0 0v16h16V0H0zm13 13h-2V5H8v8H3V3h10v10z"/></g></symbol><symbol id="icon-pinterest" viewBox="0 0 16 16"><g><path d="M8 1.069A6.93 6.93.0 005.475 14.453c-.059-.547-.116-1.391.025-1.988.125-.541.813-3.444.813-3.444s-.206-.416-.206-1.028c0-.963.559-1.684 1.253-1.684.591.0.878.444.878.975.0.594-.378 1.484-.575 2.306-.166.691.344 1.253 1.025 1.253 1.231.0 2.178-1.3 2.178-3.175.0-1.659-1.194-2.819-2.894-2.819-1.972.0-3.128 1.478-3.128 3.009.0.597.228 1.234.516 1.581.056.069.066.128.047.2a95.89 95.89.0 01-.194.787c-.031.128-.1.153-.231.094-.866-.403-1.406-1.669-1.406-2.684.0-2.188 1.587-4.194 4.578-4.194 2.403.0 4.272 1.712 4.272 4.003.0 2.388-1.506 4.313-3.597 4.313-.703.0-1.362-.366-1.588-.797.0.0-.347 1.322-.431 1.647-.156.603-.578 1.356-.862 1.816a6.93 6.93.0 008.984-6.622A6.931 6.931.0 008.001 1.068z"/></g></symbol><symbol id="icon-search" viewBox="0 0 16 16"><g><path d="M15.504 13.616l-3.79-3.223c-.392-.353-.811-.514-1.149-.499a6 6 0 10-.672.672c-.016.338.146.757.499 1.149l3.223 3.79c.552.613 1.453.665 2.003.115s.498-1.452-.115-2.003zM6 10a4 4 0 110-8 4 4 0 010 8z"/></g></symbol><symbol id="icon-strava" viewBox="0 0 24 24"><g><path d="M15.387 17.944l-2.089-4.116h-3.065L15.387 24l5.15-10.172h-3.066m-7.008-5.599 2.836 5.598h4.172L10.463.0l-7 13.828h4.169"/></g></symbol><symbol id="icon-threads" viewBox="0 0 100 100"><g><path d="M48.793 51.383c-2.204.298-3.997 1.235-5.035 2.644-.85 1.148-1.145 2.546-.88 4.139.25 1.484.71 4.252 7.99 4.252 6.972.0 8.895-7.01 9.426-10.856-1.853-.369-3.868-.558-6.019-.558-1.75.0-3.58.124-5.482.379z"/><path d="M97.432 20.541C95.764 11.247 88.7 4.188 79.437 2.557c-19.5-3.429-39.563-3.39-58.888.003-9.257 1.663-16.316 8.722-17.981 17.994A171.192 171.192.0 000 50.077c0 9.779.864 19.66 2.568 29.358 1.63 9.264 8.688 16.328 17.998 18.002A171.463 171.463.0 0050.083 1e2c9.772.0 19.647-.861 29.354-2.563 9.442-1.663 16.338-8.56 18-18.002A170.58 170.58.0 001e2 50.077c0-9.881-.861-19.812-2.568-29.536zM79.854 40.407c-1.771.59-3.678-.439-4.23-2.224-3.987-12.831-11.436-18.065-25.704-18.065-17.323.0-25.392 10.02-25.392 31.53.0 18.16 8.911 27.922 25.771 28.226 7.15.249 13.57-2.043 17.633-6.02 2.773-2.713 4.241-6.045 4.241-9.626.0-3.776-1.284-6.815-3.819-9.036a12.92 12.92.0 00-1.609-1.198c-1.771 9.443-7.692 15.186-15.877 15.186-10.75.0-13.905-5.385-14.658-9.898-.572-3.424.16-6.631 2.107-9.27 2.134-2.893 5.536-4.789 9.583-5.33 4.382-.586 8.477-.575 12.155-.038-.606-2.612-1.814-4.746-3.51-6.017-3.797-2.792-10.698-2.527-14.485 2.354a3.372 3.372.0 01-4.743.602 3.381 3.381.0 01-.603-4.743c6.256-8.073 17.377-8.4 23.861-3.644 3.825 2.872 6.154 7.699 6.598 13.414 2.129.91 4.02 2.075 5.64 3.494 4.002 3.511 6.12 8.392 6.12 14.124.0 5.363-2.226 10.5-6.272 14.46-5.19 5.076-13.045 7.958-21.658 7.958-.281.0-.557-.006-.834-.011-20.587-.368-32.401-13.121-32.401-34.987.0-25.408 10.817-38.29 32.152-38.29 17.334.0 27.253 7.037 32.16 22.82a3.38 3.38.0 01-2.226 4.229z"/></g></symbol><symbol id="icon-tumblr" viewBox="0 0 16 16"><g><path d="M9.001 7v3.659c0 .928-.012 1.463.086 1.727.098.262.342.534.609.691.354.212.758.318 1.214.318.81.0 1.289-.107 2.09-.633v2.405a9.089 9.089.0 01-1.833.639A7.93 7.93.0 019.369 16a4.9 4.9.0 01-1.725-.276 4.195 4.195.0 01-1.438-.79c-.398-.343-.672-.706-.826-1.091s-.23-.944-.23-1.676V6.556H3.003V4.29c.628-.204 1.331-.497 1.778-.877a4.386 4.386.0 001.08-1.374C6.133 1.505 6.32.825 6.422.0h2.579v4H13v3H9.001z"/></g></symbol><symbol id="icon-twitter" viewBox="0 0 16 16"><g><path d="M16 3.538a6.461 6.461.0 01-1.884.516 3.301 3.301.0 001.444-1.816 6.607 6.607.0 01-2.084.797 3.28 3.28.0 00-2.397-1.034A3.28 3.28.0 007.882 6.029 9.321 9.321.0 011.116 2.598a3.284 3.284.0 001.015 4.381A3.301 3.301.0 01.643 6.57v.041A3.283 3.283.0 003.277 9.83a3.291 3.291.0 01-1.485.057 3.293 3.293.0 003.066 2.281 6.586 6.586.0 01-4.862 1.359 9.286 9.286.0 005.034 1.475c6.037.0 9.341-5.003 9.341-9.341.0-.144-.003-.284-.009-.425a6.59 6.59.0 001.637-1.697z"/></g></symbol><symbol id="icon-vimeo" viewBox="0 0 16 16"><g><path d="M15.994 4.281c-.072 1.556-1.159 3.691-3.263 6.397-2.175 2.825-4.016 4.241-5.522 4.241-.931.0-1.722-.859-2.366-2.581-.431-1.578-.859-3.156-1.291-4.734-.478-1.722-.991-2.581-1.541-2.581-.119.0-.538.253-1.256.753l-.753-.969c.791-.694 1.569-1.388 2.334-2.081 1.053-.909 1.844-1.387 2.372-1.438 1.244-.119 2.013.731 2.3 2.553.309 1.966.525 3.188.647 3.666.359 1.631.753 2.447 1.184 2.447.334.0.838-.528 1.509-1.588.669-1.056 1.028-1.862 1.078-2.416.097-.912-.262-1.372-1.078-1.372a2.98 2.98.0 00-1.184.263c.787-2.575 2.287-3.825 4.506-3.753 1.641.044 2.416 1.109 2.322 3.194z"/></g></symbol><symbol id="icon-wordpress" viewBox="0 0 16 16"><g><path d="M2 8c0 2.313 1.38 4.312 3.382 5.259L2.52 5.622A5.693 5.693.0 002 8zm10.05-.295c0-.722-.266-1.222-.495-1.612-.304-.482-.589-.889-.589-1.371.0-.537.418-1.037 1.008-1.037.027.0.052.003.078.005A6.064 6.064.0 008 2.156 6.036 6.036.0 002.987 4.79c.141.004.274.007.386.007.627.0 1.599-.074 1.599-.074.323-.018.361.444.038.482.0.0-.325.037-.687.055l2.185 6.33 1.313-3.835-.935-2.495a12.304 12.304.0 01-.629-.055c-.323-.019-.285-.5.038-.482.0.0.991.074 1.58.074.627.0 1.599-.074 1.599-.074.323-.018.362.444.038.482.0.0-.326.037-.687.055l2.168 6.282.599-1.947c.259-.809.457-1.389.457-1.889zm-3.945.806-1.8 5.095a6.148 6.148.0 003.687-.093.52.52.0 01-.043-.081L8.105 8.511zm5.16-3.315c.026.186.04.386.04.601.0.593-.114 1.259-.456 2.093l-1.833 5.16c1.784-1.013 2.983-2.895 2.983-5.051a5.697 5.697.0 00-.735-2.803zM8 0a8 8 0 100 16A8 8 0 008 0zm0 15A7 7 0 118 1a7 7 0 010 14z"/></g></symbol><symbol id="icon-youtube" viewBox="0 0 16 16"><g><path d="M15.841 4.8s-.156-1.103-.637-1.587c-.609-.637-1.291-.641-1.603-.678-2.237-.163-5.597-.163-5.597-.163h-.006s-3.359.0-5.597.163c-.313.038-.994.041-1.603.678C.317 3.697.164 4.8.164 4.8S.005 6.094.005 7.391v1.213c0 1.294.159 2.591.159 2.591s.156 1.103.634 1.588c.609.637 1.409.616 1.766.684 1.281.122 5.441.159 5.441.159s3.363-.006 5.6-.166c.313-.037.994-.041 1.603-.678.481-.484.637-1.588.637-1.588s.159-1.294.159-2.591V7.39c-.003-1.294-.162-2.591-.162-2.591zm-9.494 5.275V5.578l4.322 2.256-4.322 2.241z"/></g></symbol><symbol id="icon-mastodon" viewBox="0 0 16 16"><g><path d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339.0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027.0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a4 4 0 01-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804.0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727.0-1.091.436-1.091 1.296v4.079H3.197V5.522q0-1.288.66-2.046c.456-.505 1.052-.764 1.793-.764.856.0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74.0 1.336.259 1.791.764q.662.757.661 2.046z"/></g></symbol><symbol id="icon-bluesky" viewBox="0 0 256 226"><path d="M55.491 15.172c29.35 22.035 60.917 66.712 72.509 90.686 11.592-23.974 43.159-68.651 72.509-90.686C221.686-.727 256-13.028 256 26.116c0 7.818-4.482 65.674-7.111 75.068-9.138 32.654-42.436 40.983-72.057 35.942 51.775 8.812 64.946 38 36.501 67.187-54.021 55.433-77.644-13.908-83.696-31.676-1.11-3.257-1.63-4.78-1.637-3.485-.008-1.296-.527.228-1.637 3.485-6.052 17.768-29.675 87.11-83.696 31.676-28.445-29.187-15.274-58.375 36.5-67.187-29.62 5.041-62.918-3.288-72.056-35.942C4.482 91.79.0 33.934.0 26.116.0-13.028 34.314-.727 55.491 15.172"/></symbol></svg><header class=l-header><p class="c-title p-title"><a href=https://heathhenley.dev/ class=p-title__link>Blogging by Heath™</a></p><p class=p-subtitle>A mostly technical blog and collection of my notes and thoughts</p></header><main id=main class=l-main><article class=p-article><header><h1>The Cryptopals Challenges</h1><div><div class=c-meta>Posted on
<time datetime=2023-12-29T12:58:01-05:00>Dec 29, 2023</time>
|
2391 words
|
~12mins</div></div><a href=https://heathhenley.dev/tags/cryptography class=c-tag>cryptography</a>
<a href=https://heathhenley.dev/tags/notes class=c-tag>notes</a>
<a href=https://heathhenley.dev/tags/software class=c-tag>software</a>
<a href=https://heathhenley.dev/tags/software-engineering class=c-tag>software-engineering</a></div></header><section id=js-article class=p-article__body><p><strong>TL;DR:</strong> I&rsquo;m working through the
<a href=https://cryptopals.com/>Cryptopals Cryptography Challenges</a>, starting with
knowing nothing about cryptography. These are my (not so) random notes and
takeaways from them. They generally seem to follow a pattern of introducing a
concept in cryptography (repeating key XOR, ECB mode, CBC mode, stream ciphers,
etc) and then having you break it in some way(s). I&rsquo;m hoping to turn my notes on
some of these in to more detailed posts at some point, but for now, this mostly
&lsquo;stream of thought&rsquo; that I&rsquo;m updating as I work through them.</p><p><strong>Most difficult so far</strong> - The CBC padding oracle attack was hard for me to
understand and tedious to implement.</p><p><strong>Most interesting so far</strong> - The length extension attack on SHA1 keyed MACs -
in general learning about how the Merkle-Damgard hash functions work (their
state IS the hash digest) was really cool.</p><h2 id=set-1---basics>Set 1 - Basics</h2><p>The solutions for this set are in the <a href=https://github.com/heathhenley/CryptoPals/tree/main/set1>set1 solutions</a>.</p><p>This was pretty quick and easy set to go through, but I&rsquo;m glad I didn&rsquo;t skip it.
It introduced &lsquo;repeating key XOR&rsquo; and how to break some cyphers &lsquo;statistically&rsquo;
using letter frequency.
The most interesting part of the set was
<a href=https://cryptopals.com/sets/1/challenges/6>Breaking repeating key XOR</a> and
<a href=https://github.com/heathhenley/CryptoPals/blob/main/set1/6.py>solution</a></p><h3 id=what-i-learned>What I learned</h3><p>Well, I didn&rsquo;t know anything about cryptography before starting this set, it was
fun to learn about and decrypt these basic cyphers, even if they aren&rsquo;t relevant
(directly) to real word crypto systems.</p><h2 id=set-2---block-crypto>Set 2 - Block Crypto</h2><p>Solutions for this set are in the <a href=https://github.com/heathhenley/CryptoPals/tree/main/set2>set2 solutions</a>.</p><p>This set is still basic, but starting to introduce vulnerabilities that are more
relevant to real world crypto.</p><p>Most interesting part so far was learning about byte-at-a-time ECB decryption,
challenges 12 and 14.</p><h3 id=byte-at-a-time-ecb-decryption>Byte-at-a-time ECB decryption</h3><ul><li>Byte-at-a-time ECB decryption (Simple) <a href=https://github.com/heathhenley/CryptoPals/blob/main/set2/12.py>solution</a></li><li>Byte-at-a-time ECB decryption (Harder) <a href=https://github.com/heathhenley/CryptoPals/blob/main/set2/14.py>solution</a></li></ul><p>In both of these challenges, you have a function that encrypts a user provided
string along with a secret string. The algorithm is more or less:</p><ul><li>Determine that ECB is being used</li><li>Determine the block size</li><li>Send a string of bytes that is one byte short of a full block<ul><li>This contains the first byte of the secret string, with the rest being
whatever you provide (I used all <code>A</code>s)</li><li>Then just try all possible bytes for that last byte, and match it up
with the output of the real one. The match is the first byte of the secret
string!</li></ul></li><li>Repeat the above, but with a string that is two bytes short of a full block<ul><li>This contains the first two bytes of the secret string, with the rest being
whatever you provide (I used all <code>A</code>s) - but you know the first byte from
the previous step, again - generate all possible bytes for the last byte
and match it up with the output of the real one. The match is the second
byte of the secret string!</li></ul></li><li>Repeat until you have the entire secret string!</li></ul><p>For the case with the random prefix, there&rsquo;s a little more work to do -
basically finding the padding length first and adjusting above to account for
it being there.</p><h3 id=cbc-bit-flipping-attack>CBC bit flipping attack</h3><p>Basically, you can manipulate the ciphertext to change what the resulting
plaintext is when it&rsquo;s decrypted when using CBC mode. So for example, in
this challenge the attack was to change the plaintext so that it would
decrypt to contain <code>;admin=true;</code>.</p><p>In CBC mode, when decrypting a block of ciphertext it is first decrypted as
in ECB mode, then XOR&rsquo;d with the previous block of ciphertext. The second part
is what was used in this attack. If we know then plaintext - eg we provide it,
then we can manipulate the block immediately before it so that when it&rsquo;s XOR&rsquo;d
in decryption, it will result in the plaintext we want.</p><p>My solution to this one is <a href=https://github.com/heathhenley/CryptoPals/blob/main/set2/16.py>here</a>. I always seem to have trouble with the
bit manipulation stuff so this took a bit to get working right, but the idea
is pretty clear now.</p><h3 id=what-i-learned-1>What I learned</h3><ul><li>The differences between AES <a href=https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_codebook_(ECB)>ECB mode</a> and
<a href=https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_block_chaining_(CBC)>CBC mode</a></li><li>CBC Bitflipping attack - this SO answer helped me a bit: <a href=https://crypto.stackexchange.com/a/66086/113345>https://crypto.stackexchange.com/a/66086/113345</a></li><li>I have always heard: &ldquo;don&rsquo;t use ECB&rdquo; and I have seen the famous picture of <a href=https://upload.wikimedia.org/wikipedia/commons/f/f0/Tux_ecb.jpg>Tux</a>
encrypted with ECB, but
never actually really understood why it happened or implemented a crack like
this, so it was pretty cool to see it in action.</li><li>To be sure that the message hasn&rsquo;t been tampered with like we did in the
CBC bitflipping attack, we can use a <a href=https://en.wikipedia.org/wiki/Message_authentication_code>Message Authentication Code</a>
(MAC) to sign the message, if it were HMAC&rsquo;d the modified ciphertext would
cause the MAC change and we would know it was tampered with.</li></ul><h2 id=set-3---block-and-stream-crypto>Set 3 - Block and Stream Crypto</h2><p>The solutions for this set are in the <a href=https://github.com/heathhenley/CryptoPals/tree/main/set3>set3 solutions</a></p><h3 id=cbc-padding-oracle-attack>CBC padding oracle attack</h3><p>Had a lot of trouble debugging this one because of a mistake in my padding /
unpadding functions. I relied a lot on this <a href=https://www.nccgroup.com/us/research-blog/cryptopals-exploiting-cbc-padding-oracles/>blog
post</a>
to finally get it working.
The idea here is that if some helpful developer has been a bit too helpful with
the error messages returned by the server when you send it a bad ciphertext to
decrypt CBC mode - you may be able to exploit that to decrypt the entire message. In this case if the server returns an error that specifically says when the padding is bad, versus just a generic decryption error, then you can exploit this &lsquo;padding oracle&rsquo; to decrypt the message.</p><p>In CBC mode, the IV or the previous block of ciphertext is XOR&rsquo;d with the
plaintext before it is encrypted. And in decryption, each block of ciphertext is
decrypted and then XOR&rsquo;s <strong>with the previous block of ciphertext</strong> to get the
plaintext. That&rsquo;s the key to this attack - we manipulate the n-1 block of
ciphertext (which is XOR&rsquo;d with the decrypted n block of the ciphertext on the
server) until we get a normal deserialization error instead of the padding
error. This means that the decrypted and XOR&rsquo;d block of ciphertext had valid
padding, if this is the last byte of the block, we know that</p><p>$$
CT_{n-1}^\text{last byte} \oplus PT_{n}^{\text{last byte}} = 0x01
$$</p><p>So the the last byte of the previous block of ciphertext, XOR&rsquo;d with the last
byte of the current block of plaintext is 0x01 - which we can rearrange to get
the last byte of the plaintext block:
$$
PT_{n}^{\text{last byte}} = CT_{n-1}^{\text{last byte}} \oplus 0x01
$$
Then we can repeat this process - next setting the last byte of the current
block to 0x02 and manipulating the penultimate byte of the previous block of
ciphertext until we know the padding is good, and so on, decrypting the entire
message without ever knowing the key!</p><h3 id=implement-and-break-aes-ctr-stream-cipher-mode>Implement and break AES CTR stream cipher mode</h3><p>Stream cipher mode is another way to encrypt data - instead of encrypting blocks
of the plaintext directly, you:</p><ul><li>Generate a random nonce (just a number)</li><li>Start a counter at the nonce</li><li>Generate a random key</li><li>For each block of plaintext:<ul><li>Increment the counter</li><li>Encrypt the counter with the key using some block
cipher (AES in this case), this is the &lsquo;keystream&rsquo;</li><li>XOR the resulting &lsquo;keystream&rsquo; with the plaintext to get the ciphertext</li><li>Add the ciphertext to the result
There you have it - still using the same block cipher, but to generate the
keystream for each block of plaintext, instead of to encrypt the plaintext
directly.</li></ul></li></ul><p>If the nonce is reused with the same key to encrypt different plaintexts, instead of being generated randomly each time - then each plaintext will be XOR&rsquo;d with the same keystream to get the ciphertext. This is bad - it basically
becomes a big repeating key XOR, where the &lsquo;repeating key&rsquo; is the keystream of
the length of the shortest plaintext you have. Repeating key XOR can be broken
just as demonstrated in set 1, challenge 6.</p><h3 id=mersenne-twister-prng>Mersenne Twister PRNG</h3><p>I wrote up <a href=https://heathhenley.dev/posts/python-random-module-random-notes/>some notes on
MT</a>, more
specifically the implementation in Python, because of this challenge and another
related challenge for a CTF.</p><p>In short, the Mersenne Twister is a PRNG that is used in Python&rsquo;s <code>random</code>
module and in a number of other languages and frameworks - it may be fine for
some things, but it is definitely <strong>not</strong> fine for anything with security. The
output is completely deterministic based on the seed and it can be cloned
(challenge 23) just by collecting enough consecutive outputs. The seed can also
be brute forced (challenge 22).</p><p>Challenge 24 introduced using MT output as the keystream for a stream cipher. If
this is done, then the attacker can use brute force to find the seed used for
the PRNG. It&rsquo;s a good example of why you shouldn&rsquo;t use MT for anything security
related (use a CSPRNG or some other secure way to get random numbers on your
system).</p><h3 id=what-i-learned-2>What I learned</h3><p>Problem 17 - I learned about how to break AES CBC mode encryption by using the
padding oracle attack, provided a &lsquo;padding oracle&rsquo; is available.
From problems 18, 19 and 20 - I learned about the AES CTR mode, how it works,
and how to break it if the nonce is improperly reused.
From problems 21, 22, and 23 - I learned a lot about Mersenne Twister and how it
works specifically. I wrote up more detailed notes about it in <a href=https://heathhenley.dev/posts/python-random-module-random-notes/>this
post</a>. In
short, I learned about how the Mersenne Twister works, how it&rsquo;s seeded in Python
specifically, how to clone it and crack it, what can happen (you get pwn&rsquo;d) if
you use it for something it should be used for (security) etc.</p><h2 id=set-4---stream-crypto-and-randomness>Set 4 - Stream Crypto and Randomness</h2><p>In progress&mldr; I jumped ahead again to learn more about MACs, SHA1 and HMAC as
it helped in some other CTF challenges I was working on. So far I &ldquo;completed&rdquo; 28
which just involved finding a pure python implementation of SHA1 and using it.
Then 29 involves breaking a SHA1 keyed MAC using a length extension attack which
is really interesting and was used to <a href="https://www.semanticscholar.org/paper/Flickr's-API-Signature-Forgery-Vulnerability-Duong-Rizzo/785dcbf504173746e96722e4a578ef98f1351557">break the Flickr API in 2009</a>.</p><h3 id=length-extension-attack>Length extension attack</h3><p>Here&rsquo;s my <a href=https://github.com/heathhenley/CryptoPals/blob/main/set4/29.py>sha1 keyed MAC crack</a> using a length extension attack.</p><p>This was really interesting to learn about. It&rsquo;s possible because of how the
<a href=https://en.wikipedia.org/wiki/Merkle%E2%80%93Damg%C3%A5rd_construction>Merkle-Damgard</a>
family of hash functions work. Basically, the hash is computed in blocks, with
the previous block&rsquo;s hash being used as the initial state for the next block. So
if you know the hash of a message, you can use that to set the initial state of
the hash function and continue hashing from there. With this, you can compute
the hash of some evil string to append to a message, append it, and then send it
to server - where it will actually verify!</p><p>This is how it works - assuming that we&rsquo;re trying to crack a SHA1 based message
authentication code (MAC). The server is using a secret key to sign the message
like: <code>SHA1(key || user=heath)</code>, and sending the hash along with the message, it
could be something like <code>user=heath:HASH</code>. So we know the message and the hash.
It would be great if we could add something to the message and have the server
accept it as valid&mldr;maybe changing the message to something like: <code>user=heath&amp;admin=true</code> would be neat. But if we try that, the server will receive the new
message, prepend it with the secret key, hash it, and compare it to the hash it
received - which won&rsquo;t match. But with the length extension attack, we can
actually get this to work!</p><p>Some things to note about this attack:</p><ul><li>We know the message and the hash, so we can use the hash to set the initial
state of the SHA1 function. This just splits the 40 byte hash into the 5
32-bit integers that SHA1 uses as the initial state of the hash function. In
some implementations these are h0, h1, h2, h3, and h4.</li><li>SHA1 pads the thing it&rsquo;s hashing to be a multiple of 512 bits. This means that
we don&rsquo;t exactly have the hash for <code>key || user=heath</code>, but actually for
<code>key || user=heath || padding</code>. This is important because now we need to make
that padding ourselves before continuing the attack. The padding is always
<code>100...0</code> followed by the length of the message in bits. After inevitably
messing this up a bunch, you will get it right and be able to generate the
padding to pad any message to be a multiple of 512 bits.</li><li>We don&rsquo;t actually know the length of the secret key, but really it doesn&rsquo;t
matter. We can just keep trying a bunch of reasonable lengths for the key,
assuming we have some &lsquo;oracle&rsquo; that will tell us if the hash we generate is
correct.</li></ul><p>The idea is</p><ul><li>we guess the length of the key</li><li>make the padding that the server would have made in generating the hash of
the message <code>key || user=heath</code>.</li><li>Then add the padding to the original message, and append our evil
<code>&amp;admin=true</code> - something like <code>user=heath || padding || &amp;admin=true</code>.</li><li>Set the state of SHA1 algorithm from the original hash supplied with the
message.</li><li>Hash the evil message, <code>&amp;admin=true</code>, and record the hash - this is the new
hash that will let us trick the server.</li><li>Send the new message to the server, with the new hash. If it verifies, then we
know we have the correct key length - if not, increment the key length and try
again.</li></ul><p>When the key length is correct, the server will hash the message we send it and
compare it to the hash we send along with the message. The first 512 bits of the
hash will be exactly what it hashed before - we just added the padding for it,
and that will result in the same hash as the original mac. However, the next
512 bits will be the evil part we added, <code>&amp;admin=true</code> - the server will
continue hashing with it&rsquo;s state represented by the original hash and end up
with same hash that we calculated, without knowing the secret key!</p><h3 id=what-i-learned-3>What I learned</h3><ul><li>Length extension attack on SHA1 keyed MACs: I had never seen this before so
that was pretty cool to learn about. TL;DR - use HMAC which is not vulnerable
to this attack and made for this purpose.</li></ul></section><footer><nav class="p-pagination c-pagination"><div class=c-pagination__ctrl><div class=c-pagination__newer><a href=https://heathhenley.dev/posts/add-callout-captions-to-camtasia-2023/>Newer</a></div><div class=c-pagination__older><a href=https://heathhenley.dev/posts/python-random-module-random-notes/>Older</a></div></div></nav><section class=p-related><h3></h3><div class=p-related__list><div class="swiper swiper-container"><ul class=swiper-wrapper><li class="p-related__item swiper-slide"><a href=/posts/python-random-module-random-notes/><span>Random Notes About Python's Random Module</span></a></li><li class="p-related__item swiper-slide"><a href=/posts/gh-actions-clone-windows-runner-error/><span>Error Checking out Large Repo on GitHub Actions Windows Runner</span></a></li><li class="p-related__item swiper-slide"><a href=/posts/small-company/><span>Some tips for working at a small company (mostly for devs)</span></a></li><li class="p-related__item swiper-slide"><a href=/posts/refactoring-chatbot-python-module/><span>Refactoring my Simple Python Chatbot Module</span></a></li><li class="p-related__item swiper-slide"><a href=/posts/modeling-sales-pipeline-with-monte-carlo/><span>Modeling Sales Pipeline using Monte Carlo Simulation</span></a></li><li class="p-related__item swiper-slide"><a href=/posts/update-gh-readme-with-action/><span>Update Github Profile Readme Dynamically using a Github Workflow</span></a></li></ul></div><div class=related-prev></div><div class=related-next></div></div></section><aside class=p-author><div class="c-avatar p-author__avatar"><img alt="Author Avatar" src=/heathcropped.png></div><div class=p-author__body><p class="c-title p-author__name">Heath Henley</p><p>Chemical Engineer turned Software Engineer writing about development, numerical methods, travel, and whatever else comes up that seems worth sharing</p><p><a href=mailto:heath.j.henley@gmail.com>Contact me</a></p></div></aside></footer></article></main><nav class="l-nav p-menu"><ul class=p-menu__lists><li class=p-menu__listitem><a href=/>Blog</a></li><li class=p-menu__listitem><a href=/about>About</a></li><li class=p-menu__listitem><a href=/tutoring>Tutoring</a></li><li class=p-menu__listitem><a href=/writing>Writing</a></li><li class=p-menu__listitem><a href=/reading>Reading</a></li></ul></nav><footer class=l-footer><ul class=c-links><li class=c-links__item><a href=https://bsky.app/profile/heathhenley.dev target=_blank><svg viewBox="0 0 64 64" class="c-links__icon"><title/><use xlink:href="#icon-bluesky"/></svg></a></li><li class=c-links__item><a href=https://twitter.com/Heath_Henley target=_blank><svg viewBox="0 0 64 64" class="c-links__icon"><title>twitter</title><use xlink:href="#icon-twitter"/></svg></a></li><li class=c-links__item><a href=https://instagram.com/keith_with_an_h target=_blank><svg viewBox="0 0 64 64" class="c-links__icon"><title>instagram</title><use xlink:href="#icon-instagram"/></svg></a></li><li class=c-links__item><a href=https://github.com/heathhenley target=_blank><svg viewBox="0 0 64 64" class="c-links__icon"><title>github</title><use xlink:href="#icon-github"/></svg></a></li><li class=c-links__item><a href=https://linkedin.com/in/hhenley target=_blank><svg viewBox="0 0 64 64" class="c-links__icon"><title>linkedin</title><use xlink:href="#icon-linkedin"/></svg></a></li></ul><p class=p-copyright>Heath Henley
&nbsp;&bull;&nbsp;
2025
&nbsp;&bull;&nbsp;
<a href=https://heathhenley.dev/>Blogging by Heath™</a></p></footer><script type=text/javascript src=https://heathhenley.dev/js/bundle.js defer></script></body></html>